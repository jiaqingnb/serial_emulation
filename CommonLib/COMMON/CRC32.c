
/********************************************************
*                                                      
*  文件名   ：   CRC32.c         
*  版权说明 ：   北京瑞安时代科技有限责任公司 
*  版本号   ：   1.0
*  创建时间 ：   2008.07.29
*  作者     ：   车载及协议部
*  功能描述 ：   计算32位CRC函数                                                                    
*  修改记录 ：  
*
********************************************************/ 

#include "CRC32.h"

/*CRC32查找表，copy from RSSP(RsspCommon.c) by lmy 20170416*/
const UINT32 CrcmTab[2][256] = {
{
	0x00000000,	0x1942B361,	0x328566C2,	0x2BC7D5A3,	0x650ACD84,	0x7C487EE5,	0x578FAB46,	0x4ECD1827,	
	0xCA159B08,	0xD3572869,	0xF890FDCA,	0xE1D24EAB,	0xAF1F568C,	0xB65DE5ED,	0x9D9A304E,	0x84D8832F,	
	0x18CE5601,	0x018CE560,	0x2A4B30C3,	0x330983A2,	0x7DC49B85,	0x648628E4,	0x4F41FD47,	0x56034E26,	
	0xD2DBCD09,	0xCB997E68,	0xE05EABCB,	0xF91C18AA,	0xB7D1008D,	0xAE93B3EC,	0x8554664F,	0x9C16D52E,	
	0x319CAC02,	0x28DE1F63,	0x0319CAC0,	0x1A5B79A1,	0x54966186,	0x4DD4D2E7,	0x66130744,	0x7F51B425,	
	0xFB89370A,	0xE2CB846B,	0xC90C51C8,	0xD04EE2A9,	0x9E83FA8E,	0x87C149EF,	0xAC069C4C,	0xB5442F2D,	
	0x2952FA03,	0x30104962,	0x1BD79CC1,	0x02952FA0,	0x4C583787,	0x551A84E6,	0x7EDD5145,	0x679FE224,	
	0xE347610B,	0xFA05D26A,	0xD1C207C9,	0xC880B4A8,	0x864DAC8F,	0x9F0F1FEE,	0xB4C8CA4D,	0xAD8A792C,	
	0x63395804,	0x7A7BEB65,	0x51BC3EC6,	0x48FE8DA7,	0x06339580,	0x1F7126E1,	0x34B6F342,	0x2DF44023,	
	0xA92CC30C,	0xB06E706D,	0x9BA9A5CE,	0x82EB16AF,	0xCC260E88,	0xD564BDE9,	0xFEA3684A,	0xE7E1DB2B,	
	0x7BF70E05,	0x62B5BD64,	0x497268C7,	0x5030DBA6,	0x1EFDC381,	0x07BF70E0,	0x2C78A543,	0x353A1622,	
	0xB1E2950D,	0xA8A0266C,	0x8367F3CF,	0x9A2540AE,	0xD4E85889,	0xCDAAEBE8,	0xE66D3E4B,	0xFF2F8D2A,	
	0x52A5F406,	0x4BE74767,	0x602092C4,	0x796221A5,	0x37AF3982,	0x2EED8AE3,	0x052A5F40,	0x1C68EC21,	
	0x98B06F0E,	0x81F2DC6F,	0xAA3509CC,	0xB377BAAD,	0xFDBAA28A,	0xE4F811EB,	0xCF3FC448,	0xD67D7729,	
	0x4A6BA207,	0x53291166,	0x78EEC4C5,	0x61AC77A4,	0x2F616F83,	0x3623DCE2,	0x1DE40941,	0x04A6BA20,	
	0x807E390F,	0x993C8A6E,	0xB2FB5FCD,	0xABB9ECAC,	0xE574F48B,	0xFC3647EA,	0xD7F19249,	0xCEB32128,	
	0xC672B008,	0xDF300369,	0xF4F7D6CA,	0xEDB565AB,	0xA3787D8C,	0xBA3ACEED,	0x91FD1B4E,	0x88BFA82F,	
	0x0C672B00,	0x15259861,	0x3EE24DC2,	0x27A0FEA3,	0x696DE684,	0x702F55E5,	0x5BE88046,	0x42AA3327,	
	0xDEBCE609,	0xC7FE5568,	0xEC3980CB,	0xF57B33AA,	0xBBB62B8D,	0xA2F498EC,	0x89334D4F,	0x9071FE2E,	
	0x14A97D01,	0x0DEBCE60,	0x262C1BC3,	0x3F6EA8A2,	0x71A3B085,	0x68E103E4,	0x4326D647,	0x5A646526,	
	0xF7EE1C0A,	0xEEACAF6B,	0xC56B7AC8,	0xDC29C9A9,	0x92E4D18E,	0x8BA662EF,	0xA061B74C,	0xB923042D,	
	0x3DFB8702,	0x24B93463,	0x0F7EE1C0,	0x163C52A1,	0x58F14A86,	0x41B3F9E7,	0x6A742C44,	0x73369F25,	
	0xEF204A0B,	0xF662F96A,	0xDDA52CC9,	0xC4E79FA8,	0x8A2A878F,	0x936834EE,	0xB8AFE14D,	0xA1ED522C,	
	0x2535D103,	0x3C776262,	0x17B0B7C1,	0x0EF204A0,	0x403F1C87,	0x597DAFE6,	0x72BA7A45,	0x6BF8C924,	
	0xA54BE80C,	0xBC095B6D,	0x97CE8ECE,	0x8E8C3DAF,	0xC0412588,	0xD90396E9,	0xF2C4434A,	0xEB86F02B,	
	0x6F5E7304,	0x761CC065,	0x5DDB15C6,	0x4499A6A7,	0x0A54BE80,	0x13160DE1,	0x38D1D842,	0x21936B23,	
	0xBD85BE0D,	0xA4C70D6C,	0x8F00D8CF,	0x96426BAE,	0xD88F7389,	0xC1CDC0E8,	0xEA0A154B,	0xF348A62A,	
	0x77902505,	0x6ED29664,	0x451543C7,	0x5C57F0A6,	0x129AE881,	0x0BD85BE0,	0x201F8E43,	0x395D3D22,	
	0x94D7440E,	0x8D95F76F,	0xA65222CC,	0xBF1091AD,	0xF1DD898A,	0xE89F3AEB,	0xC358EF48,	0xDA1A5C29,	
	0x5EC2DF06,	0x47806C67,	0x6C47B9C4,	0x75050AA5,	0x3BC81282,	0x228AA1E3,	0x094D7440,	0x100FC721,	
	0x8C19120F,	0x955BA16E,	0xBE9C74CD,	0xA7DEC7AC,	0xE913DF8B,	0xF0516CEA,	0xDB96B949,	0xC2D40A28,	
	0x460C8907,	0x5F4E3A66,	0x7489EFC5,	0x6DCB5CA4,	0x23064483,	0x3A44F7E2,	0x11832241,	0x08C19120},
{
	0x00000000,	0x1EF09C7E,	0x3DE138FC,	0x2311A482,	0x7BC271F8,	0x6532ED86,	0x46234904,	0x58D3D57A,	
	0xF784E3F0,	0xE9747F8E,	0xCA65DB0C,	0xD4954772,	0x8C469208,	0x92B60E76,	0xB1A7AAF4,	0xAF57368A,	
	0xFF048983,	0xE1F415FD,	0xC2E5B17F,	0xDC152D01,	0x84C6F87B,	0x9A366405,	0xB927C087,	0xA7D75CF9,	
	0x08806A73,	0x1670F60D,	0x3561528F,	0x2B91CEF1,	0x73421B8B,	0x6DB287F5,	0x4EA32377,	0x5053BF09,	
	0xEE045D65,	0xF0F4C11B,	0xD3E56599,	0xCD15F9E7,	0x95C62C9D,	0x8B36B0E3,	0xA8271461,	0xB6D7881F,	
	0x1980BE95,	0x077022EB,	0x24618669,	0x3A911A17,	0x6242CF6D,	0x7CB25313,	0x5FA3F791,	0x41536BEF,	
	0x1100D4E6,	0x0FF04898,	0x2CE1EC1A,	0x32117064,	0x6AC2A51E,	0x74323960,	0x57239DE2,	0x49D3019C,	
	0xE6843716,	0xF874AB68,	0xDB650FEA,	0xC5959394,	0x9D4646EE,	0x83B6DA90,	0xA0A77E12,	0xBE57E26C,	
	0xCC05F4A9,	0xD2F568D7,	0xF1E4CC55,	0xEF14502B,	0xB7C78551,	0xA937192F,	0x8A26BDAD,	0x94D621D3,	
	0x3B811759,	0x25718B27,	0x06602FA5,	0x1890B3DB,	0x404366A1,	0x5EB3FADF,	0x7DA25E5D,	0x6352C223,	
	0x33017D2A,	0x2DF1E154,	0x0EE045D6,	0x1010D9A8,	0x48C30CD2,	0x563390AC,	0x7522342E,	0x6BD2A850,	
	0xC4859EDA,	0xDA7502A4,	0xF964A626,	0xE7943A58,	0xBF47EF22,	0xA1B7735C,	0x82A6D7DE,	0x9C564BA0,	
	0x2201A9CC,	0x3CF135B2,	0x1FE09130,	0x01100D4E,	0x59C3D834,	0x4733444A,	0x6422E0C8,	0x7AD27CB6,	
	0xD5854A3C,	0xCB75D642,	0xE86472C0,	0xF694EEBE,	0xAE473BC4,	0xB0B7A7BA,	0x93A60338,	0x8D569F46,	
	0xDD05204F,	0xC3F5BC31,	0xE0E418B3,	0xFE1484CD,	0xA6C751B7,	0xB837CDC9,	0x9B26694B,	0x85D6F535,	
	0x2A81C3BF,	0x34715FC1,	0x1760FB43,	0x0990673D,	0x5143B247,	0x4FB32E39,	0x6CA28ABB,	0x725216C5,	
	0x8806A731,	0x96F63B4F,	0xB5E79FCD,	0xAB1703B3,	0xF3C4D6C9,	0xED344AB7,	0xCE25EE35,	0xD0D5724B,	
	0x7F8244C1,	0x6172D8BF,	0x42637C3D,	0x5C93E043,	0x04403539,	0x1AB0A947,	0x39A10DC5,	0x275191BB,	
	0x77022EB2,	0x69F2B2CC,	0x4AE3164E,	0x54138A30,	0x0CC05F4A,	0x1230C334,	0x312167B6,	0x2FD1FBC8,	
	0x8086CD42,	0x9E76513C,	0xBD67F5BE,	0xA39769C0,	0xFB44BCBA,	0xE5B420C4,	0xC6A58446,	0xD8551838,	
	0x6602FA54,	0x78F2662A,	0x5BE3C2A8,	0x45135ED6,	0x1DC08BAC,	0x033017D2,	0x2021B350,	0x3ED12F2E,	
	0x918619A4,	0x8F7685DA,	0xAC672158,	0xB297BD26,	0xEA44685C,	0xF4B4F422,	0xD7A550A0,	0xC955CCDE,	
	0x990673D7,	0x87F6EFA9,	0xA4E74B2B,	0xBA17D755,	0xE2C4022F,	0xFC349E51,	0xDF253AD3,	0xC1D5A6AD,	
	0x6E829027,	0x70720C59,	0x5363A8DB,	0x4D9334A5,	0x1540E1DF,	0x0BB07DA1,	0x28A1D923,	0x3651455D,	
	0x44035398,	0x5AF3CFE6,	0x79E26B64,	0x6712F71A,	0x3FC12260,	0x2131BE1E,	0x02201A9C,	0x1CD086E2,	
	0xB387B068,	0xAD772C16,	0x8E668894,	0x909614EA,	0xC845C190,	0xD6B55DEE,	0xF5A4F96C,	0xEB546512,	
	0xBB07DA1B,	0xA5F74665,	0x86E6E2E7,	0x98167E99,	0xC0C5ABE3,	0xDE35379D,	0xFD24931F,	0xE3D40F61,	
	0x4C8339EB,	0x5273A595,	0x71620117,	0x6F929D69,	0x37414813,	0x29B1D46D,	0x0AA070EF,	0x1450EC91,	
	0xAA070EFD,	0xB4F79283,	0x97E63601,	0x8916AA7F,	0xD1C57F05,	0xCF35E37B,	0xEC2447F9,	0xF2D4DB87,	
	0x5D83ED0D,	0x43737173,	0x6062D5F1,	0x7E92498F,	0x26419CF5,	0x38B1008B,	0x1BA0A409,	0x05503877,	
	0x5503877E,	0x4BF31B00,	0x68E2BF82,	0x761223FC,	0x2EC1F686,	0x30316AF8,	0x1320CE7A,	0x0DD05204,	
	0xA287648E,	0xBC77F8F0,	0x9F665C72,	0x8196C00C,	0xD9451576,	0xC7B58908,	0xE4A42D8A,	0xFA54B1F4}
};

/*反转表，copy from RSSP(RsspCommon.c) by lmy 20170416*/
const UINT8 Reflected_Byte[256] = {
	0x00,	0x80,	0x40,	0xC0,	0x20,	0xA0,	0x60,	0xE0,	
	0x10,	0x90,	0x50,	0xD0,	0x30,	0xB0,	0x70,	0xF0,	
	0x08,	0x88,	0x48,	0xC8,	0x28,	0xA8,	0x68,	0xE8,	
	0x18,	0x98,	0x58,	0xD8,	0x38,	0xB8,	0x78,	0xF8,	
	0x04,	0x84,	0x44,	0xC4,	0x24,	0xA4,	0x64,	0xE4,	
	0x14,	0x94,	0x54,	0xD4,	0x34,	0xB4,	0x74,	0xF4,	
	0x0C,	0x8C,	0x4C,	0xCC,	0x2C,	0xAC,	0x6C,	0xEC,	
	0x1C,	0x9C,	0x5C,	0xDC,	0x3C,	0xBC,	0x7C,	0xFC,	
	0x02,	0x82,	0x42,	0xC2,	0x22,	0xA2,	0x62,	0xE2,	
	0x12,	0x92,	0x52,	0xD2,	0x32,	0xB2,	0x72,	0xF2,	
	0x0A,	0x8A,	0x4A,	0xCA,	0x2A,	0xAA,	0x6A,	0xEA,	
	0x1A,	0x9A,	0x5A,	0xDA,	0x3A,	0xBA,	0x7A,	0xFA,	
	0x06,	0x86,	0x46,	0xC6,	0x26,	0xA6,	0x66,	0xE6,	
	0x16,	0x96,	0x56,	0xD6,	0x36,	0xB6,	0x76,	0xF6,	
	0x0E,	0x8E,	0x4E,	0xCE,	0x2E,	0xAE,	0x6E,	0xEE,	
	0x1E,	0x9E,	0x5E,	0xDE,	0x3E,	0xBE,	0x7E,	0xFE,	
	0x01,	0x81,	0x41,	0xC1,	0x21,	0xA1,	0x61,	0xE1,	
	0x11,	0x91,	0x51,	0xD1,	0x31,	0xB1,	0x71,	0xF1,	
	0x09,	0x89,	0x49,	0xC9,	0x29,	0xA9,	0x69,	0xE9,	
	0x19,	0x99,	0x59,	0xD9,	0x39,	0xB9,	0x79,	0xF9,	
	0x05,	0x85,	0x45,	0xC5,	0x25,	0xA5,	0x65,	0xE5,	
	0x15,	0x95,	0x55,	0xD5,	0x35,	0xB5,	0x75,	0xF5,	
	0x0D,	0x8D,	0x4D,	0xCD,	0x2D,	0xAD,	0x6D,	0xED,	
	0x1D,	0x9D,	0x5D,	0xDD,	0x3D,	0xBD,	0x7D,	0xFD,	
	0x03,	0x83,	0x43,	0xC3,	0x23,	0xA3,	0x63,	0xE3,	
	0x13,	0x93,	0x53,	0xD3,	0x33,	0xB3,	0x73,	0xF3,	
	0x0B,	0x8B,	0x4B,	0xCB,	0x2B,	0xAB,	0x6B,	0xEB,	
	0x1B,	0x9B,	0x5B,	0xDB,	0x3B,	0xBB,	0x7B,	0xFB,	
	0x07,	0x87,	0x47,	0xC7,	0x27,	0xA7,	0x67,	0xE7,	
	0x17,	0x97,	0x57,	0xD7,	0x37,	0xB7,	0x77,	0xF7,	
	0x0F,	0x8F,	0x4F,	0xCF,	0x2F,	0xAF,	0x6F,	0xEF,	
	0x1F,	0x9F,	0x5F,	0xDF,	0x3F,	0xBF,	0x7F,	0xFF
};

/*
*  功能描述： CRC32函数，计算过程如下，注意：计算CRC是从输入数据第一个字节的最高BIT开始的
*             采用的多项式0x4c11db7L，初始值为0x00000000,未镜像，结果异或系数为0x00000000
*             如果DataLen=0，返回值也为0.
*  参数说明： pData,    数据指针
*             DataLen,  数据长度（字节）
*  返回值：   返回值为CRC值
*/
UINT32 Crc32(const UINT8 *pData,UINT32 DataLen)
{
    UINT32 Crc;
    UINT32 i;


    /*生成多项式：0x4c11db7L;  */
    const static UINT32 CrcTable[256] = {
        0x00000000,0x04c11db7,0x09823b6e,0x0d4326d9,0x130476dc,0x17c56b6b,
        0x1a864db2,0x1e475005,0x2608edb8,0x22c9f00f,0x2f8ad6d6,0x2b4bcb61,
        0x350c9b64,0x31cd86d3,0x3c8ea00a,0x384fbdbd,0x4c11db70,0x48d0c6c7,
        0x4593e01e,0x4152fda9,0x5f15adac,0x5bd4b01b,0x569796c2,0x52568b75,
        0x6a1936c8,0x6ed82b7f,0x639b0da6,0x675a1011,0x791d4014,0x7ddc5da3,
        0x709f7b7a,0x745e66cd,0x9823b6e0,0x9ce2ab57,0x91a18d8e,0x95609039,
        0x8b27c03c,0x8fe6dd8b,0x82a5fb52,0x8664e6e5,0xbe2b5b58,0xbaea46ef,
        0xb7a96036,0xb3687d81,0xad2f2d84,0xa9ee3033,0xa4ad16ea,0xa06c0b5d,
        0xd4326d90,0xd0f37027,0xddb056fe,0xd9714b49,0xc7361b4c,0xc3f706fb,
        0xceb42022,0xca753d95,0xf23a8028,0xf6fb9d9f,0xfbb8bb46,0xff79a6f1,
        0xe13ef6f4,0xe5ffeb43,0xe8bccd9a,0xec7dd02d,0x34867077,0x30476dc0,
        0x3d044b19,0x39c556ae,0x278206ab,0x23431b1c,0x2e003dc5,0x2ac12072,
        0x128e9dcf,0x164f8078,0x1b0ca6a1,0x1fcdbb16,0x018aeb13,0x054bf6a4,
        0x0808d07d,0x0cc9cdca,0x7897ab07,0x7c56b6b0,0x71159069,0x75d48dde,
        0x6b93dddb,0x6f52c06c,0x6211e6b5,0x66d0fb02,0x5e9f46bf,0x5a5e5b08,
        0x571d7dd1,0x53dc6066,0x4d9b3063,0x495a2dd4,0x44190b0d,0x40d816ba,
        0xaca5c697,0xa864db20,0xa527fdf9,0xa1e6e04e,0xbfa1b04b,0xbb60adfc,
        0xb6238b25,0xb2e29692,0x8aad2b2f,0x8e6c3698,0x832f1041,0x87ee0df6,
        0x99a95df3,0x9d684044,0x902b669d,0x94ea7b2a,0xe0b41de7,0xe4750050,
        0xe9362689,0xedf73b3e,0xf3b06b3b,0xf771768c,0xfa325055,0xfef34de2,
        0xc6bcf05f,0xc27dede8,0xcf3ecb31,0xcbffd686,0xd5b88683,0xd1799b34,
        0xdc3abded,0xd8fba05a,0x690ce0ee,0x6dcdfd59,0x608edb80,0x644fc637,
        0x7a089632,0x7ec98b85,0x738aad5c,0x774bb0eb,0x4f040d56,0x4bc510e1,
        0x46863638,0x42472b8f,0x5c007b8a,0x58c1663d,0x558240e4,0x51435d53,
        0x251d3b9e,0x21dc2629,0x2c9f00f0,0x285e1d47,0x36194d42,0x32d850f5,
        0x3f9b762c,0x3b5a6b9b,0x0315d626,0x07d4cb91,0x0a97ed48,0x0e56f0ff,
        0x1011a0fa,0x14d0bd4d,0x19939b94,0x1d528623,0xf12f560e,0xf5ee4bb9,
        0xf8ad6d60,0xfc6c70d7,0xe22b20d2,0xe6ea3d65,0xeba91bbc,0xef68060b,
        0xd727bbb6,0xd3e6a601,0xdea580d8,0xda649d6f,0xc423cd6a,0xc0e2d0dd,
        0xcda1f604,0xc960ebb3,0xbd3e8d7e,0xb9ff90c9,0xb4bcb610,0xb07daba7,
        0xae3afba2,0xaafbe615,0xa7b8c0cc,0xa379dd7b,0x9b3660c6,0x9ff77d71,
        0x92b45ba8,0x9675461f,0x8832161a,0x8cf30bad,0x81b02d74,0x857130c3,
        0x5d8a9099,0x594b8d2e,0x5408abf7,0x50c9b640,0x4e8ee645,0x4a4ffbf2,
        0x470cdd2b,0x43cdc09c,0x7b827d21,0x7f436096,0x7200464f,0x76c15bf8,
        0x68860bfd,0x6c47164a,0x61043093,0x65c52d24,0x119b4be9,0x155a565e,
        0x18197087,0x1cd86d30,0x029f3d35,0x065e2082,0x0b1d065b,0x0fdc1bec,
        0x3793a651,0x3352bbe6,0x3e119d3f,0x3ad08088,0x2497d08d,0x2056cd3a,
        0x2d15ebe3,0x29d4f654,0xc5a92679,0xc1683bce,0xcc2b1d17,0xc8ea00a0,
        0xd6ad50a5,0xd26c4d12,0xdf2f6bcb,0xdbee767c,0xe3a1cbc1,0xe760d676,
        0xea23f0af,0xeee2ed18,0xf0a5bd1d,0xf464a0aa,0xf9278673,0xfde69bc4,
        0x89b8fd09,0x8d79e0be,0x803ac667,0x84fbdbd0,0x9abc8bd5,0x9e7d9662,
        0x933eb0bb,0x97ffad0c,0xafb010b1,0xab710d06,0xa6322bdf,0xa2f33668,
        0xbcb4666d,0xb8757bda,0xb5365d03,0xb1f740b4
    };

    i = 0;
    Crc = 0;

    while( i < DataLen )
    {   
        Crc = (Crc<<8) ^ CrcTable[ (Crc>>24) ^ pData[i]  ] ;   
		i++;
    }
    return Crc;
}
/*
*  功能描述： BigFileCrc32函数，计算比较大的文件的CRC码
*  参数说明： pData,    数据指针
*            DataLen,  数据长度（字节）
*			 CrcNum 拆分校验的次数
*            CrcFlag校验是否完成标志
*            *CrcCode计算得到的CRC码 
*  返回值  ： 0x55校验完成;0xff未校验完成:0xaa校验出错
*  修改时间:2016-03-14  作者:任赟军 
*合并说明：由互联互通引入 add by qxt 20161210
*/
UINT8 BigFileCrc32(const UINT8 *pData,UINT32 DataLen,UINT8 CrcNum,UINT32 *CrcCode)
{
	static   UINT32 i = 0;
	static UINT32 SplitLength = 0;
	static UINT8 CalculateNum = 0;
	UINT8 CrcFlag = 0xff;
	UINT8 M = 0;

	

    /*生成多项式：0x4c11db7L;  */
    const static UINT32 CrcTable[256] = {
        0x00000000,0x04c11db7,0x09823b6e,0x0d4326d9,0x130476dc,0x17c56b6b,
        0x1a864db2,0x1e475005,0x2608edb8,0x22c9f00f,0x2f8ad6d6,0x2b4bcb61,
        0x350c9b64,0x31cd86d3,0x3c8ea00a,0x384fbdbd,0x4c11db70,0x48d0c6c7,
        0x4593e01e,0x4152fda9,0x5f15adac,0x5bd4b01b,0x569796c2,0x52568b75,
        0x6a1936c8,0x6ed82b7f,0x639b0da6,0x675a1011,0x791d4014,0x7ddc5da3,
        0x709f7b7a,0x745e66cd,0x9823b6e0,0x9ce2ab57,0x91a18d8e,0x95609039,
        0x8b27c03c,0x8fe6dd8b,0x82a5fb52,0x8664e6e5,0xbe2b5b58,0xbaea46ef,
        0xb7a96036,0xb3687d81,0xad2f2d84,0xa9ee3033,0xa4ad16ea,0xa06c0b5d,
        0xd4326d90,0xd0f37027,0xddb056fe,0xd9714b49,0xc7361b4c,0xc3f706fb,
        0xceb42022,0xca753d95,0xf23a8028,0xf6fb9d9f,0xfbb8bb46,0xff79a6f1,
        0xe13ef6f4,0xe5ffeb43,0xe8bccd9a,0xec7dd02d,0x34867077,0x30476dc0,
        0x3d044b19,0x39c556ae,0x278206ab,0x23431b1c,0x2e003dc5,0x2ac12072,
        0x128e9dcf,0x164f8078,0x1b0ca6a1,0x1fcdbb16,0x018aeb13,0x054bf6a4,
        0x0808d07d,0x0cc9cdca,0x7897ab07,0x7c56b6b0,0x71159069,0x75d48dde,
        0x6b93dddb,0x6f52c06c,0x6211e6b5,0x66d0fb02,0x5e9f46bf,0x5a5e5b08,
        0x571d7dd1,0x53dc6066,0x4d9b3063,0x495a2dd4,0x44190b0d,0x40d816ba,
        0xaca5c697,0xa864db20,0xa527fdf9,0xa1e6e04e,0xbfa1b04b,0xbb60adfc,
        0xb6238b25,0xb2e29692,0x8aad2b2f,0x8e6c3698,0x832f1041,0x87ee0df6,
        0x99a95df3,0x9d684044,0x902b669d,0x94ea7b2a,0xe0b41de7,0xe4750050,
        0xe9362689,0xedf73b3e,0xf3b06b3b,0xf771768c,0xfa325055,0xfef34de2,
        0xc6bcf05f,0xc27dede8,0xcf3ecb31,0xcbffd686,0xd5b88683,0xd1799b34,
        0xdc3abded,0xd8fba05a,0x690ce0ee,0x6dcdfd59,0x608edb80,0x644fc637,
        0x7a089632,0x7ec98b85,0x738aad5c,0x774bb0eb,0x4f040d56,0x4bc510e1,
        0x46863638,0x42472b8f,0x5c007b8a,0x58c1663d,0x558240e4,0x51435d53,
        0x251d3b9e,0x21dc2629,0x2c9f00f0,0x285e1d47,0x36194d42,0x32d850f5,
        0x3f9b762c,0x3b5a6b9b,0x0315d626,0x07d4cb91,0x0a97ed48,0x0e56f0ff,
        0x1011a0fa,0x14d0bd4d,0x19939b94,0x1d528623,0xf12f560e,0xf5ee4bb9,
        0xf8ad6d60,0xfc6c70d7,0xe22b20d2,0xe6ea3d65,0xeba91bbc,0xef68060b,
        0xd727bbb6,0xd3e6a601,0xdea580d8,0xda649d6f,0xc423cd6a,0xc0e2d0dd,
        0xcda1f604,0xc960ebb3,0xbd3e8d7e,0xb9ff90c9,0xb4bcb610,0xb07daba7,
        0xae3afba2,0xaafbe615,0xa7b8c0cc,0xa379dd7b,0x9b3660c6,0x9ff77d71,
        0x92b45ba8,0x9675461f,0x8832161a,0x8cf30bad,0x81b02d74,0x857130c3,
        0x5d8a9099,0x594b8d2e,0x5408abf7,0x50c9b640,0x4e8ee645,0x4a4ffbf2,
        0x470cdd2b,0x43cdc09c,0x7b827d21,0x7f436096,0x7200464f,0x76c15bf8,
        0x68860bfd,0x6c47164a,0x61043093,0x65c52d24,0x119b4be9,0x155a565e,
        0x18197087,0x1cd86d30,0x029f3d35,0x065e2082,0x0b1d065b,0x0fdc1bec,
        0x3793a651,0x3352bbe6,0x3e119d3f,0x3ad08088,0x2497d08d,0x2056cd3a,
        0x2d15ebe3,0x29d4f654,0xc5a92679,0xc1683bce,0xcc2b1d17,0xc8ea00a0,
        0xd6ad50a5,0xd26c4d12,0xdf2f6bcb,0xdbee767c,0xe3a1cbc1,0xe760d676,
        0xea23f0af,0xeee2ed18,0xf0a5bd1d,0xf464a0aa,0xf9278673,0xfde69bc4,
        0x89b8fd09,0x8d79e0be,0x803ac667,0x84fbdbd0,0x9abc8bd5,0x9e7d9662,
        0x933eb0bb,0x97ffad0c,0xafb010b1,0xab710d06,0xa6322bdf,0xa2f33668,
        0xbcb4666d,0xb8757bda,0xb5365d03,0xb1f740b4
    };
	
	#if 0
	printf("FirstData:");
	for(M  = 4;M <104;M++)
	{
		printf("%x",pData[M]);
	}
	printf("\n");
	#endif
	
	if((0 != DataLen)&&(0 != CrcNum)&&(0xff == CrcFlag))
	{
		/*计算本文件单周期校验数据长度*/
		SplitLength =  DataLen/CrcNum;
	
		if(CalculateNum<CrcNum)
		{	
		
			while( i < (SplitLength+(CalculateNum*SplitLength)))
			{   
				*CrcCode = (*CrcCode<<8) ^ CrcTable[ (*CrcCode>>24) ^ pData[i]] ;   
				i++;
			}
				/*累加校验的周期数*/
			CalculateNum = CalculateNum+1;
		}
		else
		{
			while( i < DataLen)
			{   
				*CrcCode = (*CrcCode<<8) ^ CrcTable[(*CrcCode>>24) ^ pData[i]] ;   
				i++;
			}
		}
			/*校验完成清空静态变量*/
		if(i == DataLen)
		{
			  i = 0;
			  SplitLength = 0;
			  CalculateNum  = 0;
			  CrcFlag = 0x55;
		}
	}
	else
	{
			CrcFlag = 0xaa;
	}
	
	return CrcFlag;
}

/*************************************************************
*  功能描述： Crc32计算函数，使用CRC32查找表1
*  参数说明：
*             pData,    数据指针
*             DataLen,  数据长度（字节）
*  返回值：   返回值crc32Result为CRC值
*  说明：     为保障平台小型化系统处理的安全性增加该CRC算法
*             add by lmy 20180411
**************************************************************/
UINT32 Crc32_1(const UINT8 *pData, UINT32 DataLen)
{
	UINT32 crc32Result = 0;

	/*入口参数检查*/
	if ((NULL != pData) && (0 < DataLen))
	{
		crc32Result = Crc32_common(pData, DataLen, CrcmTab[0]);/*使用CRC32查找表计算CRC值*/
	} 
	else
	{
		/*入口参数不合法*/
		crc32Result = 0;
	}

	return crc32Result;
}

/*************************************************************
*  功能描述： Crc32函数，使用CRC32查找表2
*  参数说明：
*             pData,    数据指针
*             DataLen,  数据长度（字节）
*  返回值：   返回值crc32Result为CRC值
*  说明：     为保障平台小型化系统处理的安全性增加该CRC算法
*             add by lmy 20180411
**************************************************************/
UINT32 Crc32_2(const UINT8 *pData, UINT32 DataLen)
{
	UINT32 crc32Result = 0;

	/*入口参数检查*/
	if ((NULL != pData) && (0 < DataLen))
	{
		crc32Result = Crc32_common(pData, DataLen, CrcmTab[1]);/*使用CRC32查找表计算CRC值*/
	} 
	else
	{
		/*入口参数不合法*/
		crc32Result = 0;
	}

	return crc32Result;
}

/*************************************************************
*  功能描述： Crc32计算函数
*  参数说明：
*             pData,    	数据指针
*             DataLen,  	数据长度（字节）
*			  CRC32Table,	CRC32查找表
*  返回值：   返回值crc32Result为CRC值
*  说明：     为保障平台小型化系统处理的安全性增加该CRC算法,
*			  该函数与RSSP-I协议中的(RsspCommon.c)CRC_Compute_Crc函数功能相同，
*			  但是参数不一样，需要注意。
*             add by lmy 20180411
**************************************************************/
UINT32 Crc32_common(const UINT8 *pData, UINT32 DataLen, const UINT32 *CRC32Table)
{
	UINT32 index = 0;
	UINT32 crc32Result = 0;
	
	/*入口参数检查*/
	if ((NULL != pData) && (0 < DataLen) && (NULL != CRC32Table))
	{
		/*依据相应的查找表计算CRC*/
		for(index = 0; index < DataLen; index++)
		{
			crc32Result = (crc32Result >> 8) ^ CRC32Table[(crc32Result ^ Reflected_Byte[*pData]) & UINT8_MAX];
			pData++;
		}
	} 
	else
	{
		/*入口参数不合法*/
		crc32Result = 0;
	}
	
	return crc32Result;
}
